{% liquid
  assign block_st = block.settings
  assign section_st = section.settings
  assign enable_skeleton_loading = section_st.enable_skeleton_loading
  assign product = closest.product
  assign products_group = product.metafields.custom.product_grouped | split: ',' | uniq
%}
{% if products_group.size > 0 %}
  {% if enable_skeleton_loading %}<div class="skeleton-loading">{% endif %}
  <h2 class="h5 mt-0 heading-letter-spacing">
    {{ block_st.heading }}
  </h2>
  <product-group
    class="block mb-25"
    {{ block.shopify_attributes }}
  >
    <script type="application/json" class="productGroup">
      {%- liquid
          assign products_grouped = product.metafields.custom.product_grouped | split: ','
      -%}
      [{{ product.id }},{%- comment %}<locksmith:bf7e>{% endcomment -%}{%- assign locksmith_eea4_forloop__size = 0 %}{%- for item in products_grouped -%}{% capture var %}{% render 'locksmith-variables', scope: 'subject', subject: item, variable: 'transparent' %}{% endcapture %}{% if var == 'true' %}{% assign locksmith_eea4_forloop__size = locksmith_eea4_forloop__size | plus: 1 %}{% endif %}{% endfor %}{% assign locksmith_eea4_forloop__index = nil -%}{%- comment %}</locksmith:bf7e>{% endcomment -%}{%- for item in products_grouped -%}{%- comment %}<locksmith:2d84>{% endcomment -%}{%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: item, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% if locksmith_eea4_forloop__index == nil %}{% assign locksmith_eea4_forloop__index = 1 %}{% assign locksmith_eea4_forloop__index0 = 0 %}{% else %}{% assign locksmith_eea4_forloop__index = locksmith_eea4_forloop__index | plus: 1 %}{% assign locksmith_eea4_forloop__index0 = locksmith_eea4_forloop__index0 | plus: 1 %}{% endif %}{% if locksmith_eea4_forloop__index == 1 %}{% assign locksmith_eea4_forloop__first = true %}{% else %}{% assign locksmith_eea4_forloop__first = false %}{% endif %}{% if locksmith_eea4_forloop__index == locksmith_eea4_forloop__size %}{% assign locksmith_eea4_forloop__last = true %}{% else %}{% assign locksmith_eea4_forloop__last = false %}{% endif %}{% assign locksmith_eea4_forloop__rindex = locksmith_eea4_forloop__size | minus: locksmith_eea4_forloop__index | minus: 1 %}{% assign locksmith_eea4_forloop__rindex0 = locksmith_eea4_forloop__size | minus: locksmith_eea4_forloop__index0 | minus: 1 %}{% else %}{% continue %}{% endif -%}{%- comment %}</locksmith:2d84>{% endcomment -%}{{ item | split: 'Product/' | last | split: '"' | first }}{%- unless locksmith_eea4_forloop__last -%},{%- endunless locksmith_eea4_forloop__last -%}{%- endfor -%}]
    </script>
  </product-group>
  {% if enable_skeleton_loading %}</div>{% endif %}
{% endif %}
{% schema %}
{
  "name": "t:blocks.product.product_grouped.name",
  "tag": null,
  "settings": [
    {
      "type": "paragraph",
      "content": "t:sections.main-product.blocks.product_grouped.settings.info"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.main-product.blocks.product_grouped.settings.heading"
    }
  ],
  "presets": [
    {
      "name": "t:blocks.product.product_grouped.name"
    }
  ]
}
{% endschema %}
